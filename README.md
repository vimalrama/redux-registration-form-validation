A not-so-straight-forward example of a using Redux-Form's SyncValidation to validate a form with nested levels (`FormSection`s), while showing errors on both the top and the bottom levels, and manually triggering validation by dispatching a redux action.

The requirements are deceptivley simple. The form should validate that a user added his name, a valid email, and at least one bank account.

At first glance, one might want to use a nested form with seperate validation to enter the bank account details. But [Redux-Form does not support nested forms](https://github.com/erikras/redux-form/issues/2446#issuecomment-272501744).

Instead, Redux-Form has a concept of [`FormSection`](https://redux-form.com/7.0.4/docs/api/formsection.md/)s, which is quite nice, except that [it does not support validation](https://github.com/erikras/redux-form/issues/2150).

On top of that, Redux-Form's [SyncValidation does not provide an api to manually trigger validation](https://stackoverflow.com/questions/40886568/how-to-re-trigger-validations-manually-in-reduxform). Which we will need at various points in our app to validate the nested bank details form, and the bank accounts.

The example takes advantage of Redux-Form's SyncValidation, and redux-form-material-ui components, while customizing the validation to match the requirements.

The code is well-commented. The `bankAccounts` virtual field is used to display an error on the top level component. Its job is to make sure the user has entered at least one bank account. It validates using the props received from the redux state. In the component prop, we only show the error message obtained from redux-form.

```jsx
<Field
  name="bankAccounts"
  type="text"
  component={({ meta: { touched, error } }) => <span style={{ fontSize: '12px', color: 'rgb(244, 67, 54)' }}>{touched && error}</span>}
/>
```

To add the bank accounts, we used a FormSection. This gives us the desired nesting of the bank account details. The individual fields will be at `values.bankAccount.IBAN` and `values.bankAccount.BankName`. We need to validate the individual field values of the FormSection (for example: prevent saving if the IBAN is invalid, we can validate the IBAN using https://github.com/arhs/iban.js). We also want to hide the inner validations when the bank details form is hidden.

We use another virtual field `validate` to manually trigger validation at various points. For example, when removing all the added bank accounts, redux-form will not trigger validation because they were not added inside the form `values`. They were added in Redux state. So we need a way to tell Redux-Form that something changed and we need to run the validation again. All we need is to dispatch a `change` or `blur` action on a registered field. So we add a virtual field:

```jsx
<Field
   name="validate"
   type="text"
   component={() => <div style={{ display: 'none' }} />}
   label=""
/>
```

Now we can trigger validation by dispatching a redux action, using one of Redux-Form's exported action creators: Blur.

```js
this.props.dispatch(blur('registration', 'validate', Math.random()));
```

In some cases, we only want to show the errors on the bank details form. (for example, all the form is empty, and the user clicks Save Bank, while all the fields are still untouched). Redux-Form advises to only show error messages when the Field is `touched`. And this is the implemented standard in redux-form-material-ui. By default, when the form is submitted, Redux-Form calls `touch` on all the fields. So we cannot use `handleSubmit()` here. So, we need to `touch` the bank details form fields to show the errors. We use the exported `touch` action creator from redux-form.

```js
this.props.dispatch(touch('registration', 'bankAccount.IBAN', 'bankAccount.bankName'));
```

Then in the submit function, we combine the values generated by redux-form and the bankAccounts from the redux-state to create the desired output.

You can play around with the form at https://mohamed-ismat.github.io/redux-registeration-form-validation/ . 

![alt text](https://user-images.githubusercontent.com/22646941/30784296-4439635c-a15b-11e7-8637-727756f08a36.gif)




